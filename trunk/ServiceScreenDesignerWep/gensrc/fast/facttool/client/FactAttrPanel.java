/*
 * GWT compliant generated by Fujaba - CodeGen2 version 03.12.2009
 */

package fast.facttool.client;

import com.google.gwt.user.client.ui.SuggestBox;
import fast.common.client.FactAttribute;
import com.google.gwt.user.client.ui.TreeItem;
import com.google.gwt.user.client.ui.HorizontalPanel;
import fast.facttool.client.AttributeTextBox;
import fast.facttool.client.DeleteAttributeButton;
import com.google.gwt.user.client.ui.MultiWordSuggestOracle;
import java.util.*;
import fast.common.client.FactType;
import fast.common.client.ServiceDesigner;
import fujaba.web.runtime.client.reflect.*;
import fujaba.web.runtime.client.*;
import java.util.*;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.event.dom.client.ClickEvent;




public class FactAttrPanel implements PropertyChangeClient
{

   public void removeAllFrom(String className) 
   {
   }
   
   /**
   Return ArrayList of all atrr names
   */
   public java.util.ArrayList arrayListOfAttrNames() 
   {
      java.util.ArrayList vec = new java.util.ArrayList();
   	
      return vec;
   }

   // generic set and get methods
   public void set (String fieldName, Object value)
   {
   }  

   public void add (String fieldName, Object value)
   {
      set (fieldName, value);
   }

   public Object get (String fieldName)
   {
      return null;
   }
	protected final PropertyChangeSupport listeners = new PropertyChangeSupport(this);

	public void addPropertyChangeListener(PropertyChangeListener listener)
	{
		getPropertyChangeSupport().addPropertyChangeListener(listener);
	}

	public void removePropertyChangeListener(PropertyChangeListener listener)
	{
		getPropertyChangeSupport().removePropertyChangeListener(listener);
	}

	public void addPropertyChangeListener(String property, PropertyChangeListener listener)
	{
		getPropertyChangeSupport().addPropertyChangeListener(property, listener);
	}

	public void removePropertyChangeListener(String property, PropertyChangeListener listener)
	{
		getPropertyChangeSupport().removePropertyChangeListener(property, listener);
	}

	public PropertyChangeSupport getPropertyChangeSupport()
	{
		return listeners;
	}


   // create attributes for all objects in all states of this statechart
   private HorizontalPanel panel;
   private AttributeTextBox nameBox;
   private ServiceDesigner designer;
   private String tname;
   private FactType factType;
   private SuggestBox typeBox;
   private Iterator fujaba__IterDesignerToSomeType;
   private MultiWordSuggestOracle oracle;
   private TreeItem parentItem;
   private Object _TmpObject;
   private FactType someType;
   private DeleteAttributeButton deleteAttrButton;

   public void start()
   {
      initStateChart();
      // call doAction on initial state
      build.doAction();
   }

   public void start(FAction parent)
   {
      initStateChart();
      //set parent of rootState
      build.setToParent(parent);
      // call doAction on rootState
      build.doAction();
   }

   // GWT statechart code
   public void initStateChart()
   {
      if(build != null)
         return;

      attrTypeChangeListener = new AttrTypeChangeListener ();
      build = new Build ();
      fillSuggestBox = new FillSuggestBox ();
      typeBoxSelectionHandler = new TypeBoxSelectionHandler ();
      // NONE

      //build.addToFollowers("auto", fillSuggestBox);
      // NONE

      //build.addToFollowers("factAttribute.change", attrTypeChangeListener);
      // NONE

      //build.addToFollowers("typeBox.select", typeBoxSelectionHandler);
   }


   private AttrTypeChangeListener attrTypeChangeListener;
   public class AttrTypeChangeListener extends FAction
   {
       public void doAction()
       {
   		 boolean fujaba__Success = false;

         // story pattern storypatternwiththis
         try 
         {
            fujaba__Success = false; 

            // check object typeBox is really bound
            JavaSDM.ensure ( typeBox != null );
            // assign attribute typeBox
            typeBox.setText (factAttribute.getFactType());
            fujaba__Success = true;
         }
         catch ( JavaSDMException fujaba__InternalException )
         {
            fujaba__Success = false;
         }



       }

   }

   private Build build;
   public class Build extends FAction
   {
       public void doAction()
       {
   		 boolean fujaba__Success = false;

         // story pattern storypatternwiththis
         try 
         {
            fujaba__Success = false; 

            // check object factAttribute is really bound
            JavaSDM.ensure ( factAttribute != null );
            // check object parent is really bound
            JavaSDM.ensure ( parent != null );
            // create object panel
            panel = new HorizontalPanel ( );

            // create object nameBox
            nameBox = new AttributeTextBox ( );

            // create object typeBox
            typeBox = new SuggestBox ( );

            // create object deleteAttrButton
            deleteAttrButton = new DeleteAttributeButton ( );

            // create object parentItem
            parentItem = parent.addItem(panel);

            // assign attribute nameBox
            nameBox.setAttrName ("attrName");
            // assign attribute typeBox
            typeBox.setText (factAttribute.getFactType());
            // collabStat call
            nameBox.start(panel, factAttribute);
            // collabStat call
            panel.add(typeBox);
            // collabStat call
            deleteAttrButton.start(panel, factAttribute, parentItem);
            fujaba__Success = true;
         }
         catch ( JavaSDMException fujaba__InternalException )
         {
            fujaba__Success = false;
         }


         typeBox.addSelectionHandler(typeBoxSelectionHandler);
         factAttribute.addPropertyChangeListener(attrTypeChangeListener);

   		 if( autoGuardBuild1 == null)
   		 {
   			 autoGuardBuild1 = new AutoGuardBuild1();
   			 autoGuardBuild1.setSource(build);
   			 autoGuardBuild1.setTarget(fillSuggestBox);
   			 build.addToAutoTransitions(autoGuardBuild1.toString(), autoGuardBuild1);
   		 }

   		 doAuto();
       }

      private AutoGuardBuild1 autoGuardBuild1;
      private class AutoGuardBuild1 extends FGuard
      {
      }

   }

   private FillSuggestBox fillSuggestBox;
   public class FillSuggestBox extends FAction
   {
       public void doAction()
       {
   		 boolean fujaba__Success = false;

         // story pattern storypatternwiththis
         try 
         {
            fujaba__Success = false; 

            // check object factAttribute is really bound
            JavaSDM.ensure ( factAttribute != null );
            // check object typeBox is really bound
            JavaSDM.ensure ( typeBox != null );
            // search to-one link factAttributes from factAttribute to factType
            factType = factAttribute.getOwner ();

            // check object factType is really bound
            JavaSDM.ensure ( factType != null );

            // search to-one link factTypes from factType to designer
            designer = factType.getServiceDesigner ();

            // check object designer is really bound
            JavaSDM.ensure ( designer != null );

            // search to-one link suggestOracle from typeBox to oracle
            _TmpObject = typeBox.getSuggestOracle ();

            // ensure correct type and really bound of object oracle
            JavaSDM.ensure ( _TmpObject instanceof MultiWordSuggestOracle );
            oracle = (MultiWordSuggestOracle) _TmpObject;


            // iterate to-many link factTypes from designer to someType
            fujaba__Success = false;
            fujaba__IterDesignerToSomeType = designer.iteratorOfFactTypes ();

            while ( fujaba__IterDesignerToSomeType.hasNext () )
            {
               try
               {
                  someType = (FactType) fujaba__IterDesignerToSomeType.next ();

                  // check object someType is really bound
                  JavaSDM.ensure ( someType != null );
                  // collabStat call
                  tname = someType.getTypeName();
                  // collabStat call
                  oracle.add(tname);
                  // collabStat call
                  oracle.add(tname + "List");

                  fujaba__Success = true;
               }
               catch ( JavaSDMException fujaba__InternalException )
               {
                  fujaba__Success = false;
               }
            }
            JavaSDM.ensure (fujaba__Success);



            fujaba__Success = true;
         }
         catch ( JavaSDMException fujaba__InternalException )
         {
            fujaba__Success = false;
         }



       }

   }

   private TypeBoxSelectionHandler typeBoxSelectionHandler;
   public class TypeBoxSelectionHandler extends FAction
   {
       public void doAction()
       {
   		 boolean fujaba__Success = false;

         // story pattern storypatternwiththis
         try 
         {
            fujaba__Success = false; 

            // check object factAttribute is really bound
            JavaSDM.ensure ( factAttribute != null );
            // assign attribute factAttribute
            factAttribute.setFactType (typeBox.getText());
            fujaba__Success = true;
         }
         catch ( JavaSDMException fujaba__InternalException )
         {
            fujaba__Success = false;
         }



       }

   }

   // my style test for method.vm


   // my style test for method.vm


   // my style test for method.vm

   public void start (FactAttribute factAttribute , TreeItem parent )
   { 
      // copy parameters to attributes
      this.factAttribute = factAttribute;
      this.parent = parent;
      start();
   }

   // attributes for action container method parameters 
   public FactAttribute factAttribute;
   public TreeItem parent;


   public void removeYou()
   {
   }
}


