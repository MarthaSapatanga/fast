<html> 
<head> 
    <meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1'> 
	  <title>Insert title here</title> 
	<script type='text/javascript'> 
	//all functions from util 
	function from(str, sign, sepNr) 
	{	 
		//Trims all needless whitespaces 
		var tmp = new String(Trim(str)); 
		var save = ''; 
		if (sepNr < 1) 
		{ 
			sepNr = 1; 
		} 
		//build the result string 
		while (tmp.indexOf(sign) != -1 && sepNr > 0) 
		{ 
			save = tmp.substring(tmp.indexOf(sign), tmp.indexOf(sign) 
					+ sign.length); 
			tmp = tmp.substring(tmp.indexOf(sign) + sign.length, tmp.length); 
			sepNr--; 
		} 
		//append last apperance of sign 
		tmp = save + tmp; 
		return tmp; 
	} 
	function until(str, sign, sepNr) 
	{ 
		//Trims all needless whitespaces 
		var tmp = new String(Trim(str)); 
		var res = ''; 
		var length = sign.length; 
		if(sepNr < 1) 
		{ 
			sepNr = 1; 
		} 
		//build the result string 
		while(tmp.indexOf(sign) != -1 && sepNr > 0) 
		{ 
			res += tmp.substring(0, tmp.indexOf(sign) + length); 
		tmp = tmp.substring(tmp.indexOf(sign) + length, tmp.length); 
			sepNr--; 
		} 
		return res; 
	} 
	function charsFromTo(str, from, to) 
	{ 
		//Trims all needless whitespaces 
		var tmp = new String(Trim(str)); 
		var res = ''; 
		if(from < 1) 
		{ 
			from = 1; 
		} 
		if(to > tmp.length) 
		{ 
			to = tmp.length; 
		} 
		//build the result string 
		for(from; from <= to; from++) 
		{ 
			res += charAt(tmp, from); 
		} 
		return res; 
	} 
	function charAt(str, index) 
	{ 
		//Trims all needless whitespaces 
		//var tmp = new String(Trim(str)); 
		var res = ''; 
		if(index < 1) 
		{ 
			index = 1; 
		} 
		else if(index > str.length) 
		{ 
			index = str.length; 
		} 
		index = index - 1; 
		res = str.charAt(index); 
		return res; 
	} 
	function wordsFromTo(str, from, to) 
	{ 
		//Trims all needless whitespaces 
		var tmp = new String(Trim(str)); 
		var res = ''; 
		var _split = tmp.split(' '); 
		var length = _split.length; 
		if(from < 1) 
		{ 
			from = 1; 
		} 
		if(to > length) 
		{ 
			to = length; 
		} 
		//build the result string} 
		for(from; from <= to; from++) 
		{ 
			res =  res + wordAt(str, from) + ' '; 
		} 
		return res; 
	} 
	function wordAt(str, nr) 
	{ 
		//Trims all needless whitespaces 
		var res = new String(Trim(str)); 
		var _split = res.split(' '); 
		var length = _split.length; 
		nr = nr -1; 
		if(nr < 0 || nr >= length) 
		{ 
			nr = length-1; 
		} 
		res = _split[nr]; 
		return res; 
	} 
	function Trim(str) 
	{ 
		return RTrim(LTrim(str)); 
	} 
	function LTrim(str) 
	{ 
		var whitespace = new String(' '); 
		var s = new String(str); 
		if (whitespace.indexOf(s.charAt(0)) != -1) 
		{ 
			var j=0, i = s.length;} 
			while (j < i && whitespace.indexOf(s.charAt(j)) != -1) 
				j++; 
			s = s.substring(j, i); 
		} 
		return s; 
	} 
	function RTrim(str) 
	{ 
		var whitespace = new String(' '); 
		var s = new String(str); 
		if (whitespace.indexOf(s.charAt(s.length-1)) != -1) 
		{ 
			var i = s.length - 1; 
			while (i >= 0 && whitespace.indexOf(s.charAt(i)) != -1) 
				i--; 
			s = s.substring(0, i+1); 
		} 
		return s; 
	} 

function transform(search_key) 
{
   //fill imput data into request template 
   var prerequest = 'http://open.api.sandbox.ebay.com/shopping?appid=KasselUn-efea-4b93-9505-5dc2ef1ceecd&version=517&callname=FindItems&ItemSort=EndTime&QueryKeywords=USB&responseencoding=XML'; 

  //search and replace (Operator - Time replacement) 
  prerequest = prerequest.replace(/<search_key>/g,search_key); 
 
  var request = prerequest; 

  //the code for sending a request to same domain resource 
  var xmlHttp = null; 
  var respone = null; 
  try 
  { 
     // Mozilla, Opera, Safari sowie Internet Explorer (ab v7) 
     xmlHttp = new XMLHttpRequest(); 
  } 
  catch(e) 
  { 
      try 
      { 
          // MS Internet Explorer (ab v6) 
          xmlHttp  = new ActiveXObject('Microsoft.XMLHTTP'); 
      } 
      catch(e) 
      { 
            try 
            { 
                  // MS Internet Explorer (ab v5) 
                  xmlHttp  = new ActiveXObject('Msxml2.XMLHTTP'); 
            } 
            catch(e) 
            { 
                  xmlHttp  = null; 
            } 
      } 
  } 

  if (xmlHttp) 
  { 
      //the <resource> tag should contain the requested information 
      xmlHttp.open('GET', request, true); 
      xmlHttp.onreadystatechange = function () { 
            if (xmlHttp.readyState == 4) 
            { 
                  //the response should save requested information 
                  respone = xmlHttp.responseText; 
            } 
      }; 

      xmlHttp.send(null); 
  } 
 
  var xmlResponse =  response; 

  //the outputPort variable 
  String List = ''; 
 

  //the transformation code 
  wordsFromTo(trimBoth(xmlResponse.getElementsByTagName(Title).getItem(1)), 1-2) + charsFromTo(trimBoth(xmlResponse.getElementsByTagName(ItemID).getItem(1)), 1-7); 
trimBoth(xmlResponse.getElementsByTagName(ConvertedCurrentPrice).getItem(1) + ' Euro and  + trimBoth(xmlResponse.getElementsByTagName(ShippingServiceCost).getItem(1) + ' Euro for shipping; 
until(from(trimBoth(xmlResponse.getElementsByTagName(ViewItemURLForNaturalSearch).getItem(1)), 'c', 1)., 'com', 1); 
 

}
</script>
	</head>
		<body>
			<form name=f1>
				<input type='text' name=t2 value='Harry' size='50'> 
				<input type=button value='request and transform' 
					onclick='this.form.t1.value=transform(this.form.t2.value)'>	
				<br><br><br><br> 
				RESULT:	
				<input type=text name=t1 value='press the button above..' size=200>
			</form>
		</body>
	</html>
